$(document).ready((function(){const e=new LazyLoad({callback_error:function(e){e.innerText="Unavailable",e.setAttribute("style",`background-image: url(${e.getAttribute("data-original")})`)}}),n=new tui.ImageEditor("#tui-image-editor",{includeUI:{initMenu:"filter",menuBarPosition:"left"}});window.onresize=function(){n.ui.resizeEditor()};let t="date",a="desc",i="",d="",o=[],l=[],s=[],c=!1,r=0,f="",m=1,u={id:0,type:"folder or file",name:"File or Folder Name"},p=u,h=!1,g=[],b=[],v=1;$("body").tooltip({selector:"[data-bs-title]"});const y=$(document).find("#filemanage_container"),w=$(document).find("#filemanager_tree"),_=$(document).find(".context_menu"),x=$(document).find(".filemanager_files_container"),C=$(document).find("#fileUploadModal .files-list"),F=$(document).find("#previewFileModal"),k=$(document).find(".spinner.full"),E=y.find(".circleLoading"),U=$(document).find("#addFolderModal"),L=$(document).find("#showFileModal"),M=$(document).find("#infoFileModal"),R=$(document).find(".file_uloading_corner_notification");function S(e,n="success",t="Success"){new Notify({title:t,text:e,autoclose:!0,autotimeout:3e3,status:n})}function I(e){try{let n;try{n=e.responseJSON.message}catch(e){n=e.responseText}S(n||"Unable to perform action!!!","error","Error")}catch(e){S("Unable to perform action!!!","error","Error")}}function T(e,n=0){const t=.9*n+"rem";let a="";for(let i=0;i<e.length;i++){const d=e[i];d.children.length>0?(a+=`\n                    <div \n                        class="list-group-item border-0 collapsed ${d.id===f?"active":""}" \n                        data-bs-toggle="collapse" \n                        data-bs-target="#tree-item-${d.id}"\n                        style="padding-left:${t}" aria-level="${n}" aria-expanded="false"\n                        data-type="folder"\n                        data-fileName="${d.name}"\n                        data-id="${d.id}"\n                    >\n                        <i class="state-icon fa fa-angle-right fa-fw"></i>\n                        <i class="item-icon fa fa-folder"></i>\n                        <span class="folder">${d.name}</span>\n                    </div>\n                    <div role="group" class="list-group collapse" id="tree-item-${d.id}">\n                `,a+=T(e[i].children,n+1),a+="</div>"):a+=`<div \n                    class="list-group-item border-0 ${d.id===f?"active":""}" \n                    style="padding-left:${t}" \n                    aria-level="${n}"\n\n                    data-type="folder"\n                    data-fileName="${d.name}"\n                    data-id="${d.id}"\n                >\n                    <i class="state-icon iconSpace">&nbsp;</i>\n                    <i class="item-icon fa fa-folder"></i>\n                    <span class="folder">${d.name}</span>\n                </div>`}return a}function N(e){try{return e.split(".").pop().toLowerCase()}catch(e){return!1}}function j(e){const n=N(e);return["jpg","jpeg","png","gif","bmp","svg","webp","ico"].includes(n)}function P(e){let n="faicon",t='<span class="fm-item-thumbnail fas fa-file"></span>';const a=N(e.name),i=j(e.name);i?(n="faimage",t=`<div class="fm-item-thumbnail lazy" data-original="${e.url}" data-bg="${e.thumbnail}"></div>`):"pdf"===a?t='<span class="fm-item-thumbnail fas fa-file-pdf"></span>':"doc"!==a&&"docx"!==a||(t='<span class="fm-item-thumbnail fas fa-file-word"></span>');let d="";return FM_SELECT_FILE&&(d=`<div class="form-check">\n                <input class="form-check-input fileSelect" name="file_select" data-type="${i?"image":"file"}" type="${FM_SELECT_MULTIPLE?"checkbox":"radio"}">\n            </div>`),`<div \n            class="fm-folder border fm-item ${n}"\n            data-type="file"\n            data-fileType="child"\n            data-fileName="${e.basename}"\n            data-id="${e.id}"\n            data-ext="${a}"\n        >\n            ${d}\n            ${t}\n            <span class="fm-item-title">${e.display_name}</span>\n        </div>`}function O(e){const n=1024,t=1048576,a=1073741824;return e>=a?(e/a).toFixed(2)+" GB":e>=t?(e/t).toFixed(2)+" MB":e>=n?(e/n).toFixed(2)+" KB":e+" bytes"}function B(){const e=$(".startUploadFiles"),n=$(".clearUploadFiles");o.length>0?(e.attr("disabled",!1),n.attr("disabled",!1)):(e.attr("disabled",!0),n.attr("disabled",!0))}function D(e){const n=FM_SELECT_FILE?FM_SELECT_MULTIPLE?"checkbox":"radio":"checkbox",t=$(`<div class="fm-folder border fm-item faimage" data-type="file" data-filetype="child" data-filename="${e.basename}" data-id="${e.id}" data-ext="${e.extension}">\n                        <div class="form-check">\n                            <input class="form-check-input fileSelect" name="file_select" data-type="image" type="${n}">\n                        </div>\n                        <div class="fm-item-thumbnail" style="background-image:url(${e.uri})"></div>\n                        <span class="fm-item-title">${e.display_name}</span>\n                    </div>`),a=x.find(".fm-folder[data-type=folder]");a.length>0?a.last().after(t):x.prepend(t),l.push(e)}function z(e){let n;for(let t=0;t<e.length;t++){const a=e[t];n=$(`<div class="single-file">\n                <div class="fileIcon"><i class="fa-solid fa-file-lines"></i></div>\n                <div class="info">\n                    <div class="d-flex justify-content-between align-items-center w-100 mb-1">\n                        <h4 class="name">${a.name}</h4>\n                        <p class="size">${O(a.size)}</p>\n                    </div>\n\n                    <div class="progress">\n                        <div class="progress-bar progress-bar-striped bg-primary" role="progressbar" style="width: 0;" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"></div>\n                    </div>\n                </div>\n                <div class="deleteFile"><i class="fa-solid fa-trash" data-bs-title="Remove File" data-bs-toggle="tooltip"></i></div>\n            </div>`),C.append(n),o.push({file:a,ele:n})}B()}function A(){k.addClass("show"),J()}$(document).on("change","[name=sortingOrder]",(function(){a=$(this).val(),v=1,J()})),$(document).on("change","[name=sortingBy]",(function(){t=$(this).val(),v=1,J()})),$(document).on("change","[name=filterBy]",(function(){d=$(this).val(),v=1,J()})),$(document).on("click",".finalUploadURL",(function(){const e=$(document).find("#uploadURLModal"),n=e.find("input").val();if(!function(e){let n;try{n=new URL(e)}catch(e){return!1}return"http:"===n.protocol||"https:"===n.protocol}(n))return S("Invalid URL","error","Error"),!1;const t=$(this),a=t.html();$.ajax({url:FM_REQ_URL+"ajax/upload/",type:"POST",data:{url:n},beforeSend:function(){t.prop("disabled",!0).html('<i class="fa fa-spinner fa-spin"></i> Uploading . . .')},success:function(n){D(n.data),e.modal("hide")},error:function(){S("Unable to upload URL","error","Error")},complete:function(){t.prop("disabled",!1).html(a)}})})),$(document).on("click",".addNewUpload",(function(){$(document).find("#fileUploadModal").modal("show")})),$(document).on("click",".addNewUrl",(function(){$(document).find("#uploadURLModal").find("input").val(""),$(document).find("#uploadURLModal").modal("show")})),$(document).on("click","#searchBtn",(function(){J()})),$(document).on("click",".startUploadFiles",(function e(){if(r<o.length){h=!0;const n=o[r],t=n.file,a=n.ele,i=a.find(".progress-bar"),d=a.find(".deleteFile"),l=new FormData;l.append("file",t),l.append("folder_id",f),$.ajax({url:FM_REQ_URL+"ajax/upload/",type:"POST",data:l,contentType:!1,processData:!1,beforeSend:function(){d.html('<i class="fa-solid fa-spinner fa-spin" data-bs-title="Uploading . . ." data-bs-toggle="tooltip"></i>'),d.addClass("noaction"),i.removeClass("bg-success bg-danger").addClass("bg-primary")},xhr:function(){const e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",(function(e){if(e.lengthComputable){const n=e.loaded/e.total*100;i.width(n+"%"),i.attr("aria-valuenow",n)}})),e},success:function(){i.removeClass("bg-primary").addClass("bg-success"),d.html('<i class="fa-solid fa-circle-check text-success" data-bs-title="Upload Successfully" data-bs-toggle="tooltip"></i>')},error:function(){i.removeClass("bg-primary").addClass("bg-danger"),d.html('<i class="fa-solid fa-triangle-exclamation text-danger" data-bs-title="Unable to upload File" data-bs-toggle="tooltip"></i>'),d.attr("data-index",r)},complete:function(){r++,e()}})}else h&&(v=1,J())})),$(document).on("click",".clearUploadFiles",(function(){o=[],B(),C.html(""),r=0})),$(document).on("click",".deleteFile:not(.noaction)",(function(){const e=$(this).data("index");$(this).closest(".single-file").slideUp(400,(function(){$(this).remove()})),o.splice(e,1),B()}));const Q=$(document).find(".body_dragging");$(document.body).on("dragover dragenter",(function(e){e.preventDefault(),$(document.body).addClass("dragover")})),Q.on("dragleave",(function(){$(document.body).removeClass("dragover")})),Q.on("drop",(function(e){e.preventDefault(),$(document.body).removeClass("dragover");const n=e.originalEvent.dataTransfer.files;$(document).find("#fileUploadModal").hasClass("show")?z(n):function(e){R.addClass("uploading");const n=R.find(".progress-bar");!function t(a){if(a>=e.length)return void R.removeClass("uploading");const i=e[a];R.find(".name").text(i.name),R.find(".size").text(`${a+1}/${e.length}`);const d=new FormData;d.append("file",i),d.append("folder_id",f),$.ajax({url:FM_REQ_URL+"ajax/upload/",type:"POST",data:d,contentType:!1,processData:!1,beforeSend:function(){n.removeClass("bg-success bg-danger").addClass("bg-primary")},xhr:function(){const e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",(function(e){if(e.lengthComputable){const t=e.loaded/e.total*100;n.width(t+"%"),n.attr("aria-valuenow",t)}})),e},success:function(e){D(e.data),n.removeClass("bg-primary").addClass("bg-success")},error:function(){S(`Unable to upload file: ${i.name}`,"error","Error")},complete:function(){t(a+1)}})}(0)}(n)})),$(document).on("change","#fileDropRef",(function(){z(this.files),$(this).val("")}));document.getElementById("fileUploadModal").addEventListener("hidden.bs.modal",(function(){o=[],B(),C.html(""),r=0,h&&A()})),$(document).on("click",".refreshBtn",A);document.getElementById("addFolderModal").addEventListener("hidden.bs.modal",(function(){const e=$(document).find("#addFolderModal");e.find("input").val(""),e.find(".createNewFolder").attr("data-id","").text("Create"),u={id:0,name:"",type:""}}));function H(){_.hide(),u={id:0,name:"",type:""}}function q(e,n){const t=n.data("type")??"window",a=n.data("id")??0;if(u={type:t,id:a,name:n.data("filename")??"window"},"file"===t){const e=l.filter((e=>e.id===a));if(!(e.length>0))return!1;u={...u,...e[0]}}else if("folder"===t){const e=s.filter((e=>e.id===a));if(!(e.length>0))return!1;u={...u,...e[0]}}_.find(".dropdown-item").removeClass("d-none"),_.find(".paste").addClass("d-none"),b.length>0?_.find(".selectall").html('<i class="fa-solid fa-xmark"></i> Unselect All'):_.find(".selectall").html('<i class="fa-solid fa-check-double"></i> Select All'),"folder"===t?(_.find(".createFolder").removeClass("d-none"),_.find(".showURL").addClass("d-none"),_.find(".download").addClass("d-none"),_.find(".filedivider").addClass("d-none"),_.find(".edit").addClass("d-none")):"file"===t?(_.find(".createFolder").addClass("d-none"),_.find(".showURL").removeClass("d-none"),_.find(".download").removeClass("d-none"),_.find(".filedivider").removeClass("d-none"),"images"===u?.category?_.find(".edit").removeClass("d-none"):_.find(".edit").addClass("d-none")):(_.find(".createFolder").removeClass("d-none"),_.find(".open").addClass("d-none"),_.find(".rename").addClass("d-none"),_.find(".edit").addClass("d-none"),_.find(".download").addClass("d-none"),_.find(".filedivider").addClass("d-none"),_.find(".showURL").addClass("d-none"),"window"===t&&""===f&&(_.find(".delete").addClass("d-none"),_.find(".info").addClass("d-none"),_.find(".dropdown-divider").addClass("d-none"))),_.css({position:"fixed",display:"block",left:e.pageX,top:e.pageY})}function X(){const e=$(document).find(".deleteFiles");e.length>0&&(b.length>0?e.removeClass("d-none"):e.addClass("d-none"))}document.getElementById("previewFileModal").addEventListener("hidden.bs.modal",(function(){u={id:0,name:"",type:""}})),$(document).on("click",".context_menu .selectall",(function(){const e=$(document).find(".fileSelect");e.length>0?b.length>0?(e.prop("checked",!1).trigger("change"),S(`Unselected (${e.length}) files`,"info","Unselected")):(e.prop("checked",!0).trigger("change"),S(`Selected (${e.length}) files`,"info","Selected")):S("No files to select","info","Select"),H()})),$(document).on("click",".context_menu .rename",(function(){U.find(".folderNewName").val(u.basename),U.find(".createNewFolder").attr("data-id",u.id).attr("data-type",u.type).text("Update"),U.modal("show"),H()})),$(document).on("click",".context_menu .showURL",(function(){"file"===u.type&&(L.find("input").val(u.url),L.find("a").attr("href",u.url),L.modal("show"),H())})),$(document).on("click",".context_menu .info",(function(){M.find(".modal-title").text("file"===u.type?"File Information":"Folder Information"),M.find(".fileName").text(u.name);const e=M.find(".fileDimensions");u?.width&&u?.height?(e.text(`${u.width}x${u.height}`),e.closest("tr").removeClass("d-none")):e.closest("tr").addClass("d-none"),M.find(".fileSize").text(O(u.size)),"file"===u.type?(M.find(".filePath").text(u.uri),M.find(".fileURL").html(`<a href="${u.url}" target="_blank">${u.url}</a>`),M.find(".fileURL, .filePath").closest("tr").removeClass("d-none")):M.find(".fileURL, .filePath").closest("tr").addClass("d-none"),M.find(".fileCreated").text(u.uploaded_at),M.find(".fileModified").text(u.modify_date),M.modal("show"),H()})),M[0].addEventListener("bs.modal.hide",(function(){M.find(".fileName, .fileDimensions, .fileSize, .filePath, .fileURL, .fileCreated, .fileModified").html("")})),document.getElementById("showFileModal").addEventListener("hidden.bs.modal",(function(){L.find("input").val(""),L.find("a").attr("href","#")})),$(document).on("click",".context_menu .createFolder",(function(){u.createFolder="menu",U.find(".folderNewName").val(""),U.find(".createNewFolder").attr("data-id",""),U.modal("show")})),$(document).on("click",".context_menu .edit",(function(){if("images"===u?.category){p=u;const e=$(document).find("#editImageModal");e.find(".modal-title").text("Edit Image"),$(document).find(".tui-image-editor-header-buttons").html('\n                <button type="button" class="btn btn-secondary ie_saveAsNew">Save Image as New</button>\n                <button type="button" class="btn btn-primary ie_replaceExisting">Replace Existing Image</button>\n            '),n.loadImageFromURL(u.url,u.name).then((()=>{n.ui.activeMenuEvent(),n.ui.resizeEditor(),e.modal("show")})).catch((()=>{S("Unable to load image","error","Error")}))}})),$(document).on("click",".ie_saveAsNew",(function(){console.log("Save as new",p)})),$(document).on("click",".ie_replaceExisting",(function(){console.log("Replace Existing",p)})),$(document).on("click",".context_menu .open",(function(){"folder"===u.type?(f=u.id,v=1,J()):function(e){if(j(e)){const n=`<img alt="Image" style="max-width:100%;" class="w-100 h-auto" src="${e}" />`;F.find(".modal-body").html(n),F.modal("show")}}(u.url)})),$(document).on("click",".deleteFiles",(function(){const e=$(this);confirm("Are you sure want to delete?")&&$.ajax({url:FM_REQ_URL+"ajax/delete/",type:"POST",data:{type:"file",delete_id:b},dataType:"json",beforeSend:function(){E.removeClass("d-none")},success:function(e){b.forEach((e=>{const n=$(document).find(`.fm-item[data-id=${e}][data-type=file]`);n.length>0&&n.fadeOut("slow",(function(){$(this).remove()}))})),b=[],S(e.message,"success","Removed")},error:I,complete:function(){E.addClass("d-none"),e.addClass("d-none")}})})),$(document).on("click",".context_menu .delete",(function(){if(confirm("Are you sure want to delete?")){const e=u.type,n=u.id;H(),$.ajax({url:FM_REQ_URL+"ajax/delete/",type:"POST",data:{type:e,delete_id:[n]},dataType:"json",beforeSend:function(){E.removeClass("d-none")},success:function(t){const a=$(document).find(`.fm-item[data-id=${n}][data-type=${e}]`);if(a.length>0){a.fadeOut("slow",(function(){$(this).remove()}));const e=l.findIndex((e=>e.id===n));-1!==e&&l.splice(e,1);const t=s.findIndex((e=>e.id===n));-1!==t&&s.splice(t,1)}if("folder"===e){const e=$(document).find(`#filemanager_tree [data-id=${n}]`);e.length>0&&e.fadeOut("slow",(function(){$(this).remove()}))}S(t.message,"success","Removed")},error:I,complete:function(){E.addClass("d-none")}})}})),$(document).on("contextmenu",".fm-item, .list-group-item",(function(e){e.preventDefault(),e.stopPropagation(),q(e,$(this))})),$(document).on("contextmenu","#filemanager_sidebar, #filemanager_content",(function(e){e.preventDefault(),q(e,$(this))})),$(document).click((function(e){$(e.target).closest(".context_menu").length||$(e.target).closest("#addFolderModal").length||H()})),F[0].addEventListener("hidden.bs.modal",(function(){F.find(".modal-body").html("")})),$(document).on("click",".selectFilesForEmbed",(function(){try{let e={sender:"filehub",html:"",files:g,file:g[0]};for(let n=0;n<g.length;n++)e.html+=`<img class="img-fluid" src="${g[n].uri}" alt="Image" />`;!function(e){try{return new URLSearchParams(window.location.search).has(e)}catch(e){}return!1}("callback_fnc")?window.parent.postMessage(e):window.parent.onFileHubCallback(e,function(e){try{return new URLSearchParams(window.location.search).get(e)}catch(e){}return!1}("callback_fnc"))}catch(e){}})),X(),$(document).on("change",".fileSelect",(function(){const e=$(this).closest(".fm-item"),n=parseInt(e.attr("data-id")),t=l.findIndex((e=>e.id===n));if(-1!==t){if(FM_SELECT_FILE&&!FM_SELECT_MULTIPLE)if($(this).is(":checked"))g.length=0,b.length=0,g.push(l[t]),b.push(n);else{const e=g.findIndex((e=>e.id===n));-1!==e&&g.splice(e,1);const t=b.indexOf(n);-1!==t&&b.splice(t,1)}else if($(this).is(":checked"))g.some((e=>e.id===n))||(g.push(l[t]),b.push(n));else{const e=g.findIndex((e=>e.id===n));-1!==e&&g.splice(e,1);const t=b.indexOf(n);-1!==t&&b.splice(t,1)}X()}})),$(document).on("click",".fm-item[data-type=file]",(function(e){if(!$(e.target).is(":checkbox")){const e=$(this).find(".fileSelect");e.prop("checked",!e.prop("checked")).trigger("change")}})),$(document).on("click",".fm-item[data-type=folder]",(function(){$(this).data("id")!==f&&(f=$(this).data("id"),m=1,J())})),$(document).on("click","#filemanager_tree .list-group-item",(function(){$(this).data("id")!==f&&(f=$(this).data("id"),m=1,J())})),$(document).on("click",".breadcrumb-item.click",(function(){$(this).data("folder")!==f&&(f=$(this).data("folder"),v=1,J())})),$(document).on("click",".redirectToRoot",(function(){f="",v=1,J()})),$(document).on("click",".createNewFolder",(function(){const e=$(this).attr("data-id"),n=$(this).attr("data-type"),t=$(document).find(".folderNewName").val(),a=$(this),i=a.html();$.ajax({url:FM_REQ_URL+"ajax/folder/",type:"POST",data:{update_id:e,name:t,current_dir:u.id>0?u.id:f,file_type:n},dataType:"json",beforeSend:function(){E.removeClass("d-none"),a.prop("disabled",!0).html('<i class="fa fa-spinner fa-spin"></i> Processing . . .')},success:function(n){U.modal("hide");const t=n.data;if(e){const n=$(document).find(`.fm-item[data-id=${e}]`);if(n.length>0){n.find(".fm-item-title").text(t.display_name);const a=l.findIndex((n=>n.id===e));-1!==a&&(l[a]=t)}const a=$(document).find(`#filemanager_tree [data-id=${e}]`);if(a.length>0){a.find("span.folder").text(t.display_name);const n=s.findIndex((n=>n.id===e));-1!==n&&(s[n]=t)}}else if(x.prepend(`\n                        <div \n                            class="fm-folder fm-item border fafolder"\n                            data-type="folder"\n                            data-fileType="child"\n                            data-fileName="${t.basename}"\n                            data-id="${t.id}"\n                        >\n                            <span class="fm-item-thumbnail fas fa-folder"></span>\n                            <span class="fm-item-title">${t.display_name}</span>\n                        </div>`),s.push(t),f)if("menu"===u?.createFolder)J();else{const e=$(document).find(`#filemanager_tree [data-id=${f}]`);e.length>0&&e.next().prepend(`<div class="list-group-item border-0 " style="padding-left:0;" aria-level="1" data-type="folder" data-filename="${t.basename}" data-id="${t.id}">\n                                    <i class="state-icon iconSpace">&nbsp;</i>\n                                    <i class="item-icon fa fa-folder"></i>\n                                    <span class="folder">${t.display_name}</span>\n                                </div>`)}else"menu"===u?.createFolder?J():w.prepend(`<div class="list-group-item border-0 " style="padding-left:0;" aria-level="0" data-type="folder" data-filename="${t.basename}" data-id="${t.id}">\n                                <i class="state-icon iconSpace">&nbsp;</i>\n                                <i class="item-icon fa fa-folder"></i>\n                                <span class="folder">${t.display_name}</span>\n                            </div>`);S(n.message,"success",e>0?"Renamed":"Created")},error:I,complete:function(){E.addClass("d-none"),U.modal("hide"),H(),a.prop("disabled",!1).html(i)}})})),$(document).on("click",".addNewFolder",(function(){U.modal("show")})),$(document).on("submit",".filesSearchForm",(function(e){e.preventDefault(),i=$(".searchFilesInput").val(),J()})),$(".searchFilesInput").on("search",(function(){""===$(this).val()&&(i="",J())}));let G=!1;function J(n=!0){$.ajax({url:FM_REQ_URL+"ajax/browse/",type:"POST",data:{folder:f,page:m,sortby:t,sortorder:a,search:i,filter:d},dataType:"json",beforeSend:function(){n?k.addClass("show"):E.removeClass("d-none"),G=!0},success:function(n){let t=T(n.hiearchy);w.html(t),t=function(e){let n='<li class="breadcrumb-item click" data-folder=""><span class="d-flex align-items-center"><i class="fas fa-home me-1"></i> Home</span></li>';for(let t=0;t<e.length;t++)t+1>=e.length?n+=`<li class="breadcrumb-item active"><a>${e[t].name}</a></li>`:n+=`<li class="breadcrumb-item click" data-folder="${e[t].id}"><a>${e[t].name}</a></li>`;return n}(n.breadcrumb),$(document).find(".filemanager_content_top ol.breadcrumb").html(t),m<2&&x.html(""),function(e){for(let n=0;n<e.length;n++)x.append(`\n                <div \n                    class="fm-folder fm-item border fafolder"\n                    data-type="folder"\n                    data-fileType="${1===e[n].id?"root":"child"}"\n                    data-fileName="${e[n].name}"\n                    data-id="${e[n].id}"\n                >\n                    <span class="fm-item-thumbnail fas fa-folder"></span>\n                    <span class="fm-item-title">${e[n].name}</span>\n                </div>`)}(n.folders),function(e){for(let n=0;n<e.length;n++)x.append(P(e[n]))}(n.files.data),c=n.files.hasMore,l=1===v?n.files.data:[...l,...n.files.data],s=1===v?n.folders:[...s,...n.folders],n.folders.length<=0&&n.files.data.length<=0&&x.find("div").length<=0&&(i.length>0?x.html('<div class="no_files_and_folder_found">\n                                <span class="fas fa-folder"></span>\n                                <h3>No files and folder found according to your search query.</h3>\n                            </div>'):x.html('<div class="no_files_and_folder_found">\n                                <span class="fas fa-folder"></span>\n                                <h3>This folder is empty</h3>\n                            </div>'));try{const e=$(document).find(`#filemanager_tree .list-group-item[data-id=${f}]`);if(e.addClass("active"),e.hasClass("collapsed")){e.removeClass("collapsed").attr("aria-expanded",!0);const n=e.attr("data-bs-target");$(document).find(n).removeClass("collapse")}(a=e).parents('.list-group-item[data-type="folder"]').removeClass("collapsed").attr("aria-expanded",!0),a.parents(".list-group").addClass("show")}catch(e){}var a;try{e.update()}catch(e){}},error:I,complete:function(){k.removeClass("show"),E.addClass("d-none"),H(),h=!1,G=!1}})}J(!0);const K=$("#filemanager_files");K.scroll((function(){K.scrollTop()+K.height()>=K[0].scrollHeight-1e3&&c&&!G&&(m++,J(!1))})),$(document).on("click",".openMenuBar",(function(){$(document).find("#filemanager_sidebar").toggleClass("d-block")}))}));